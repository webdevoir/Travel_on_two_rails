<h1><%= @post.post_title %></h1>
<% unless @post.post_pictures == nil %>
  <% @post.post_pictures.each do |post_picture| %>
    <%= image_tag post_picture %>
  <% end %>
<% end %>
<p>
  <%= @post.post_content %>
</p>
<p>
  <%= @post.address1 %>
</p>
<p>
  <%= @post.address2 %>
</p>
<div class="map-container">
  <div id="map">

  </div>
  <div id="right-panel">

  </div>
</div>

<script
 src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAOPUyGan2qsdAXBODCGHa2TN6myWIxZFQ">
</script>
<script>
$(function(){

  function initMap() {
    var directionsService = new google.maps.DirectionsService;
    var directionsDisplay = new google.maps.DirectionsRenderer;
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 7,
    });
    directionsDisplay.setMap(map);
    directionsDisplay.setPanel(document.getElementById('right-panel'));

    calculateAndDisplayRoute(directionsService, directionsDisplay);
  }

  function calculateAndDisplayRoute(directionsService, directionsDisplay) {
    directionsService.route({
      origin: "<%= @post.address1 %>",
      destination: "<%= @post.address2 %>",
      travelMode: 'DRIVING',
      unitSystem: google.maps.UnitSystem.METRIC
    }, function(response, status) {
      if (status === 'OK') {
        directionsDisplay.setDirections(response);
      } else {
        window.alert('Directions request failed due to ' + status);
      }
    });
  }

  initMap()
})
</script>
