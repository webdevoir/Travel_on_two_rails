<h1>One blog page</h1>
<% if (current_user != nil) %>
  <% if (@blog.user_id == current_user.id) %>
    <h3><a href="<%= new_blog_post_url(@blog.id) %>">Make a post</a></h3>
  <% end %>
<% end %>
<% @blog.posts.each do |post| %>
  <h3><%= post.post_title %></h3>
  <p><%= post.post_content %></p>
  <div class="map-container">
    <div class="map-canvas">

    </div>
  </div>
<% end %>

<script type="text/javascript">

  function initMap() {
    var directionsDisplay = new google.maps.DirectionsRenderer();
    var directionsService = new google.maps.DirectionsService();
    var elems = document.getElementsByClassName('map-container');
    for (var i = 0; i < elems.length; i++) {
      var map = new google.maps.Map(elems[i], {
        center: {lat: 34.397, lng: -90.644},
        zoom: 3
      });
      directionsDisplay.setMap(map);
      calculateAndDisplayRoute(directionsService, directionsDisplay);
    }
  }

  function calculateAndDisplayRoute(directionsService, directionsDisplay){
    directionsService.route({
      origin: "chicago, il",
      destination: "st louis, mo",
      travelMode: 'DRIVING'
    }, function(response, status) {
      if (status === 'OK') {
        directionsDisplay.setDirections(response);
      } else {
        window.alert('Directions request failed due to ' + status);
      }
    });
  };
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAOPUyGan2qsdAXBODCGHa2TN6myWIxZFQ&callback=initMap"
  async defer></script>
